---
title:序列化_打印流
date: 2019-03-14 09:23:13
categories: Java
---

# 第一章 序列化

## 1. 序列化

- java.io.ObjectOutputStream extends OutputStream
- ObjectOutputStream:对象的序列化流
- 作用:把对象以流的方式写入到文件中保存

### 构造方法

- ObjectOutputStream(OutputStream out) 创建写入指定 OutputStream 的 ObjectOutputStream。
- 参数:OutputStream out:字节输出流

### 特有的成员方法 

- void writeObject(Object obj)：将指定的对象写入 ObjectOutputStream。

### 使用步骤

1. 创建ObjectOutputStream对象，构造方法中传入字节输出流
2. 使用ObjectOutputStream对象中的方法writeObject，把对象写入文件中
3. 释放资源

### 注意

序列化和反序列化的时候,会抛出NotSerializableException没有序列化异常。**类通过实现 java.io.Serializable 接口以启用其序列化功能。**未实现此接口的类将无法使其任何状态序列化或反序列化。

- Serializable接口也叫标记型接口
  **有:就可以序列化和反序列化**
  **没有:就会抛出 NotSerializableException异常**

## 2. 反序列化

- java.io.ObjectInputStream extends InputStream

- ObjectInputStream:对象的反序列化流

- 作用:把文件中保存的对象,以流的方式读取出来使用

### 构造方法
- ObjectInputStream(InputStream in) 创建从指定 InputStream 读取的 ObjectInputStream。

- 参数:
  InputStream in:字节输入流

### 特有的成员方法
- Object readObject()：从 ObjectInputStream 读取对象。

### 使用步骤

1. 创建ObjectInputStream对象，构造方法中传递字节输入流
2. 使用ObjectInputStream对象中的方法readObject读取保存对象的文件
3. 释放资源
4. 使用读取出来的对象（打印）

### 注意

1. readObject方法声明抛出了ClassNotFoundException(class文件找不到异常)，当不存在对象的class文件时抛出此异常
2. 反序列化的前提:
          类必须实现Serializable
          必须存在类对应的class文件
3. 当JVM反序列化对象时，能找到class文件，但是class文件在序列化对象之后发生了修改，那么反序列化操作也会失败，抛出一个`InvalidClassException`异常。**发生这个异常的原因如下：

- 该类的序列版本号与从流中读取的类描述符的版本号不匹配 
- 该类包含未知数据类型 
- 该类没有可访问的无参数构造方法 

`Serializable` 接口给需要序列化的类，提供了一个序列版本号。`serialVersionUID` 该版本号的目的在于验证序列化的对象和对应类是否版本匹配。

解决方案：成员变量处增加以下代码

```java
static  final long serialVersionUID = 42L;
```



## 3. transient关键字

- static关键字:静态关键字
   **静态优先于非静态加载到内存中(静态优先于对象进入到内存中)**
   **被static修饰的成员变量不能被序列化的,序列化的都是对象**

- **被transient修饰成员变量,不能被序列化**

# 第二章 打印流

- java.io.PrintStream:打印流
- PrintStream 为其他输出流添加了功能，使它们能够方便地打印各种数据值表示形式。
## PrintStream特点
1. 只负责数据的输出,不负责数据的读取

2. 与其他输出流不同，PrintStream 永远不会抛出 IOException

3. 有特有的方法,print,println
    void print(任意类型的值)
    void println(任意类型的值并换行)

## 构造方法
- PrintStream(File file):输出的目的地是一个文件
- PrintStream(OutputStream out):输出的目的地是一个字节输出流
- PrintStream(String fileName) :输出的目的地是一个文件路径

PrintStream extends OutputStream
继承自父类的成员方法:

- public void close() ：关闭此输出流并释放与此流相关联的任何系统资源。
- public void flush() ：刷新此输出流并强制任何缓冲的输出字节被写出。
- public void write(byte[] b)：将 b.length字节从指定的字节数组写入此输出流。
- public void write(byte[] b, int off, int len) ：从指定的字节数组写入 len字节，从偏移量 off开始输出到此输出流。
- public abstract void write(int b) ：将指定的字节输出流。

## 注意
如果使用继承自父类的write方法写数据,那么查看数据的时候会查询编码表 97->a
如果使用自己特有的方法print/println方法写数据,写的数据原样输出 97->97

## 改变打印流方向

可以改变输出语句的目的地(打印流的流向)

输出语句,默认在控制台输出

使用System.setOut方法改变输出语句的目的地改为参数中传递的打印流的目的地

static void setOut(PrintStream out)

重新分配“标准”输出流。

```java
import java.io.FileNotFoundException;
import java.io.PrintStream;

public class Demo02PrintStream {
    public static void main(String[] args) throws FileNotFoundException {
        System.out.println("我是在控制台输出");

        PrintStream ps = new PrintStream("10_IO\\目的地是打印流.txt");
        System.setOut(ps);//把输出语句的目的地改变为打印流的目的地
        System.out.println("我在打印流的目的地中输出");

        ps.close();
    }
}
```

